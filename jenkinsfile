pipeline {
    agent any
    parameters {
        choice(
            name: 'GIT_PARAM_URL',
            choices: [
                'https://github.com/skasbp/AkashGithub2025.git',
                'User1',
                'User2',
                'User3'
            ],
            description: 'Choose the repo to checkout'
        )
    }
    environment {
        ABCD = "This is my first jenkins pipeline"
        TARGET = "DevOps Engineer"
        GIT_URL = 'https://github.com/skasbp/AkashGithub2025.git'
        GIT_CREDS = 'Akash@1994'
        CHECKOUT_BRNACH = 'main'
    }
    triggers {
        pollSCM('H/5 * * * *')
        cron('H/15 * * * 1-5')
    }

    stages{
        stage ('Checkout'){
            steps {
                git (
                    branch: 'main', 
                    credentialsId: 'Akash@1994', 
                    url: 'https://github.com/skasbp/AkashGithub2025.git'
                )
                sh 'echo "Welcome to my world"'

            }
        }
        stage ('Build 1'){
            steps {
                sh '''
                    pwd
                    ls -lrt
                '''
            }
        }
        stage ('Build 2') {
            agent { label 'SLAVE 2'}
            steps {
                sh 'cat VCSfile.txt'
            }
        }
        stage ('Checking Errors for next stage') {
            steps {
                echo "This is an empty stage"
            }
        }
        stage ('CATCHERRO') {
            steps {
                catchError(buildResult: 'SUCCESS', stageResult: 'FAILURE') {
                    sh 'exit 1'
                }
            }
        }
        stage ('checking TRY CATCH ERROR') {
            steps{
                script {
                    try {
                        sh 'exit 1'
                    }
                    catch (e) {
                        echo "The error is: ${e}"
                    }
                    finally {
                        echo "This is the end of the TRY CATCH block"
                    }
                }
            }
        }
        stage ('building Parallel tasks') {
            parallel {
                stage ('Task 1') {
                    steps {
                        sh '''
                            echo "This is task 1"
                            ls -lrt
                            sleep 10
                        '''
                    }
                }
                stage ('Task 2') {
                    steps {
                        sh '''
                            echo "This is task 2"
                            pwd
                            find ./ -type f -iname 'w*.txt'
                            cat pipeline.txt
                            sleep 5
                        '''
                    }
                }
                stage ('Groovy Syntax') {
                    steps {
                        sh "echo Branch: ${env.CHECKOUT_BRNACH}"
                        sh "echo Credentials: ${env.GIT_CREDS}"
                        sh "echo giturl: ${params.GIT_PARAM_URL}"
                    }
                }
                stage ('Linux Syntax') {
                    steps {
                        sh """
                            echo $ABCD
                            echo $TARGET
                            echo ${params.GIT_PARAM_URL}
                            echo ${env.GIT_CREDS}
                            echo ${env.CHECKOUT_BRNACH}
                            """
                    }
                }
            }
        }
    }
}
